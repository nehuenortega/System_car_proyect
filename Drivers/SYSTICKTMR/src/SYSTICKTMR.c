/*
 * SYSTICKTMR.c
 *
 *  Created on: 07/06/2014
 *      Author: TinchoPC
 */


/********************************************************************************************************
*** INCLUDES
********************************************************************************************************/

#include "SYSTICKTMR.h"


/********************************************************************************************************
*** PRIVATE DEFINES
********************************************************************************************************/


/********************************************************************************************************
*** PRIVATE MACROS
********************************************************************************************************/


/********************************************************************************************************
*** PRIVATE DATA TYPES
********************************************************************************************************/


/********************************************************************************************************
*** PRIVATE TABLES
********************************************************************************************************/


/********************************************************************************************************
*** PUBLIC GLOBAL VARIABLES
********************************************************************************************************/


/********************************************************************************************************
*** PRIVATE GLOBAL VARIABLES
********************************************************************************************************/


/********************************************************************************************************
*** PRIVATE FUNCTION PROTOTYPES
********************************************************************************************************/


/********************************************************************************************************
*** CONFIGURATION ERRORS
********************************************************************************************************/


/*-----------------------------------------------------------------------------------------------------*/


/********************************************************************************************************
*** PUBLIC FUNCTIONS
********************************************************************************************************/

/***************************************************************************//**
 * @fn			SYSTICKTMR_Init()
 * @brief		Inicializa el System Tick Timer, por defecto se reinicia cada 10mSeg
 * @param[in]	state		Estado de la interrupcion: Debe ser uno de los siguientes:
 *	                        	-ENABLED
 *								-DISABLED
 * @param[in]	clock		Tipo de Clock usado: Debe ser uno de los siguientes:
 * 								-CLK_STCLK
 * 								-CLK_CPU
 *
 * @return 		void
 ******************************************************************************/
void SYSTICKTMR_Init(FUNCTIONAL_STATE state, CLK_SETUP clock)
{
	if (state == DISABLED)
	{
		(SYSTICK_TMR->STCTRL) &= ~(0x01 << SYSTICK_TMR_TICKINT);
	}
	else
	{
		(SYSTICK_TMR->STCTRL) |= (0x01 << SYSTICK_TMR_TICKINT);
	}
	if (clock == CLK_STRCLK)
	{
		(SYSTICK_TMR->STCTRL) &= ~(0x01 << SYSTICK_TMR_CLKSOURCE);
	}
	else
	{
		(SYSTICK_TMR->STCTRL) |= (0x01 << SYSTICK_TMR_CLKSOURCE);
	}

	(SYSTICK_TMR->STCTRL) |= (0x01 << SYSTICK_TMR_ENABLE);
}

/***************************************************************************//**
 * @fn			SYSTICKTMR_GetFlag()
 * @brief		Retorna el Valor del flag que corresponde con la llegada a cero del Timer
 * @param[in]	void
 *
 * @return 		BOOL
 ******************************************************************************/
BOOL SYSTICKTMR_GetFlag(void)
{
	return(GET_BIT((SYSTICK_TMR->STCTRL),SYSTICK_TMR_COUNTFLAG));
}

/***************************************************************************//**
 * @fn			SYSTICKTMR_SetCounter()
 * @brief		Setea el valor del contador del Timer
 * @param[in]	counter	Solo toma el valor de los 24 bits de menor peso
 *
 * @return 		void
 ******************************************************************************/
void SYSTICKTMR_SetCounter(uint32_t counter)
{
	(SYSTICK_TMR->STRELOAD=counter);
}

/***************************************************************************//**
 * @fn			SYSTICKTMR_GetFlag()
 * @brief		Retorna el Valor del Timer
 * @param[in]	void
 *
 * @return 		uint32_t
 ******************************************************************************/
uint32_t SYSTICKTMR_GetValue(void)
{
	return(SYSTICK_TMR->STCURR);
}

 /********************************************************************************************************
*** PRIVATE FUNCTIONS
********************************************************************************************************/


/*-----------------------------------------------------------------------------------------------------*/
